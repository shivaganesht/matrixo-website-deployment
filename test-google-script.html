<!DOCTYPE html>
<html>
<head>
    <title>Test Google Apps Script</title>
</head>
<body>
    <h1>Test Google Apps Script</h1>
    <button onclick="testScript()">Test Send Data</button>
    <div id="result"></div>

    <script>
        async function testScript() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Sending test data...';

            const testData = {
                timestamp: new Date().toISOString(),
                eventId: 'test-event',
                eventTitle: 'Test Event',
                eventDate: '2025-10-15',
                ticketType: 'General',
                ticketPrice: 499,
                fullName: 'Test User',
                contactNumber: '1234567890',
                email: 'test@example.com',
                studentId: 'TEST123',
                collegeName: 'Test College',
                department: 'CSE',
                year: '3rd Year',
                emergencyContact: '0987654321',
                address: 'Test Address',
                wantCertificate: 'no',
                wantTransport: 'yes',
                hearAboutEvent: 'matriXO',
                paymentScreenshot: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCwAB//2Q==',
                screenshotFileName: 'test.jpg',
                status: 'Test'
            };

            const scriptUrl = 'https://script.google.com/macros/s/AKfycbxpptU7OnCvB-5HFZNgZNDtd8DQnsVi_7EPRrW-ENw9yUffvPerKe-G70c65ysqis-GPA/exec';

            try {
                console.log('Sending data:', testData);
                
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });

                console.log('Response:', response);
                resultDiv.innerHTML = '✅ Request sent! Check your Google Sheet for a new row with "Test User"';
                
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = '❌ Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
